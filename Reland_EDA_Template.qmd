---
title: "Relandscaping Analysis Template"
format: html
author: Amy King-Henry
editor: visual
---

## Relandscaping Exploratory Analysis: FILL IN YOUR VARIABLE HERE

Winter 2024 - MCRS Advanced Quantitative Methods Class Project

Team #: 4

Team Members: Cherry, Janet, Katelin

#### Load Packages

```{r}
library(tidyr)
library(dplyr)
library(ggplot2)

```

#### Import your Primary file from your saved .Rdata

```{r}
carbonflux <-read.csv("CarbonFlux_Primary.csv")
vegheight <-read.csv("VegHeight_Primary.csv")

```

### Analysis

Before you begin, write your plan for analyzing this data. Add a header for each step you anticipate, then commit and push the document to Git. This may include steps such as:

-   calculating summarized variables (i.e., rates or change between time points, averages of replicated observations)

-   making figures to illuminate comparisons or relationships

-   testing assumptions and/or running models to test for significant comparisons or relationships

Never save over your Primary file. While you are playing around, only make edits under your own workspace header and on your own branch. By doing this, when you commit and push your changes to your shared repository, you avoid merge conflicts.

Once you have something good, show it to your teammates and you can agree to add it (by pasting into the chunk below) to your shared Team Analysis. The team member who updates the Team Analysis should then merge their branch with the master, and all teammates should do a fresh "pull", which will merge the new changes to your current working version. (if this is confusing, ask us for help)

#### Team Member #1 Analysis

```{r}
#take the average CO2 for the 240 second readings for Dark and Light cycles and group by native/non native
mean_cf <- carbonflux %>%
  group_by(Treatment,CycleType) %>%
  summarize(meannative = mean(CO2_ppm)) %>%
  rename(AvgCO2 = meannative)

#two-way anova
#cf_aov <-summary(aov(CO2_ppm ~ Treatment + CycleType, data = carbonflux))
#cf_aov <-summary(aov(AvgCO2 ~ Treatment + CycleType, data = mean_cf))
```

#### Team Member #2 Analysis

```{r}
#take the average of tree, shrub, grass, and forb height data for Turf and No Turf and group by transect ID
mean_vh <- vegheight |>
  group_by(Transect_ID, Turf) |>
  summarize(AvgGrass_cm = mean(Grass_Height_cm),
            AvgForb_cm = mean(Forb_Height_cm),
            AvgShrub_cm = mean(Shrub_Height_cm),
            AvgTree_cm = mean(Tree_Height_cm))

#Reshape the data into long format
mean_vh_long <- pivot_longer(mean_vh, cols = c(AvgGrass_cm, AvgShrub_cm, AvgForb_cm, AvgTree_cm), names_to = "Vegetation_Type", values_to = "Value")

```

```{r}
#Presence and absence
ps_vh <- vegheight |>
  select(Turf, Site_ID, Transect_ID, Forb_Height_cm, Grass_Height_cm, Shrub_Height_cm, Tree_Height_cm)|>
  mutate(Forb_Height_cm = case_when(
    Forb_Height_cm == 0 ~ 0,
    TRUE ~ 1)) |>
  mutate(Grass_Height_cm = case_when(
    Grass_Height_cm == 0 ~ 0,
    TRUE ~ 1)) |>
  mutate(Shrub_Height_cm = case_when(
    Shrub_Height_cm == 0 ~ 0,
    TRUE ~ 1)) |>
  mutate(Tree_Height_cm = case_when(
    Tree_Height_cm == 0 ~ 0,
    TRUE ~ 1))

#Reshape the data into long format
ps_vh_long <- pivot_longer(ps_vh, cols = c(Grass_Height_cm, Shrub_Height_cm, Forb_Height_cm, Tree_Height_cm), names_to = "Vegetation_Type", values_to = "Presence")
```

#### Team Member #3 Analysis

```{r}
```

#### Team Member #1 Workspace - Carbon Flux

```{r}

#Grouped barplot
ggplot(mean_cf, aes(x=Treatment, y=AvgCO2, fill= CycleType)) + 
  geom_bar(stat = "identity", position = "dodge") +
  labs(title="CO2 in Native vs. Nonnative Species with Dark vs. Light Conditions",
        x ="Plant Communities", y = "Average CO2", fill = "Light Cycle")+
  scale_fill_manual(values=c("Green4", "Yellow2"))+
  theme_classic() + 
  scale_y_continuous(limit = c(0,500),expand = expansion(mult = 0, add = 0))


```

#### Team Member #2 Workspace - Vegetation Height

```{r}
# Plot Turf vs No Turf
ggplot(mean_vh_long, aes(x = Transect_ID, y = Value, fill = Turf)) + 
  geom_col(position = "dodge") +
  # Separate panels for each vegetation type
  #scales = "free_y" allows the y axis scale to be independant 
  facet_wrap(~Vegetation_Type, scales = "free_y", labeller = labeller(Vegetation_Type = c("AvgForb_cm" = "Forb", "AvgGrass_cm" = "Grass", "AvgShrub_cm"= "Shrub", "AvgTree_cm" = "Tree"))) +
  labs(title="Average Vegetation In Turf vs No Turf",
        x ="Transect ID", y = "Vegetation Height (cm)", fill = "Turf")+
  scale_fill_manual(values=c("Pink", "Purple"))+
  theme_classic()

```

```{r}
# Plot presence vs absence
ggplot(ps_vh, aes(x = Turf, y = Forb_Height_cm, fill = Site_ID)) + 
  geom_col(position = "dodge")

```

#### Team Member #3 Workspace (rename)

```{r}

```
